---
指针
---


### 1 Introduction
> 这个概念一直没搞懂，以至于影响到typedef的理解，
就在此时此刻，我居然看懵来，无语--2014/08/04
#### 1.1 指针数组
包含指针的数组
#### 1.2 数组指针
指向数组变量的指针，每一次移动都以数组为单位
#### 1.3 指针函数
返回值为指针的函数
#### 1.4 函数指针
指向函数的指针变量


### 2,指针数组
> 本质上为数组，数组的元素为指针（额，这个以前怎么不知道）

#### 2.1 例子
``` gcc
    // 数组类型为int*
    int* p[2];

    // 和typedef结合使用
    typedef int* IntPtr;
    IntPtr p[2];
```


### 3,数组指针
> 指向数组的指针，本质上为一个指针
#### 3.1 例子
```gcc
    int a[2][2] = {1, 2, 3, 4};
    // 定义一个指向数组int x[2]的指针类型
    int (*p)[2];
    // 将p指向a数组中
    p = a;
    printf("%p-%p-%p-%p\n", a[0], a[1], p[0], p[1]);
    printf("%p-%p-%p\n", &a[0][1], a[1][1], a[0]+1);
```
输出结果为：
```
    0x38-0x40-0x38-0x40
    0x3c-0x44-0x3c
```
#### 3.2 分析
- 数组名a为指针，其中指针类型为一维数组，见a[0]+1的输出结果
- 数组名a是一个常量指针，所以不存在a++的操作（编译器或者gcc本身限定）
- 数组指针p和数组名常量a的操作大体类型，除了常量这个特质之外，即p++是合法的
- 声明一个数组指针是，编译器仅仅为数组指针分配一个4字节的指针内存，而数组名常量则不同


### 4,指针函数
> 本质上是一个函数，不过返回的值为指针，注意和函数指针的区别，见下文说明

#### 4.1 定义
格式：类型名\* 函数名(函数参数列表)
#### 4.2 例子与分析
``` gcc
    int* func1(int i, int j);
    char* strcat(char *dest, char *src);
```
从运算符的优先级方面来分析整个指针函数，其中
- ()的优先级大于\*，所以func1首先是一个函数
- 函数func1的参数由两个(int i, int j)
- 最后考虑函数的返回值\*,表示这个一个返回值为指针的函数


### 5,函数指针
> 本身上为一个指针，指向函数的指针
#### 5.1 定义
格式：返回值 (\*func)(函数参数列表)
注意，这并非一个函数声明哦，其一般和typedef连用
#### 5.2 分析
从运算符优先级角度考虑函数指针：
- \*说明func是一个指针
- ()标识\*func整体时一个函数，固func是一个指向函数的指针，参数类型和返回值见上说明
#### 5.3 例子
见src/macro/typedef.c中的例子说明
